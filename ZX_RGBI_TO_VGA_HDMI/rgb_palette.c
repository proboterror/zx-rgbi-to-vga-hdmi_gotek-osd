#include "rgb_palette.h"

// https://hype.retroscene.org/blog/graphics/320.html
static const rgb_palette_t rgb_palette_alone = 
{
    { 0x00, 0x00, 0x00 }, // Black
    { 0x00, 0x00, 0xA0 }, // Blue
    { 0x00, 0xA0, 0x00 }, // Green
    { 0x00, 0xA0, 0xA0 }, // Cyan
    { 0xA0, 0x00, 0x00 }, // Red
    { 0xA0, 0x00, 0xA0 }, // Magenta
    { 0xA0, 0xA0, 0x00 }, // Yellow
    { 0xA0, 0xA0, 0xA0 }, // White
    { 0x00, 0x00, 0x00 }, // Black Bright
    { 0x00, 0x00, 0xFF }, // Blue Bright
    { 0x00, 0xFF, 0x00 }, // Green Bright
    { 0x00, 0xFF, 0xFF }, // Cyan Bright
    { 0xFF, 0x00, 0x00 }, // Red Bright
    { 0xFF, 0x00, 0xFF }, // Magenta Bright
    { 0xFF, 0xFF, 0x00 }, // Yellow Bright
    { 0xFF, 0xFF, 0xFF }  // White Bright
  };

static const rgb_palette_t rgb_palette_pulsar =
{
    { 0x00, 0x00, 0x00 }, // Black
    { 0x00, 0x00, 0xCD }, // Blue
    { 0x00, 0xCD, 0x00 }, // Green
    { 0x00, 0xCD, 0xCD }, // Cyan
    { 0xCD, 0x00, 0x00 }, // Red
    { 0xCD, 0x00, 0xCD }, // Magenta
    { 0xCD, 0xCD, 0x00 }, // Yellow
    { 0xCD, 0xCD, 0xCD }, // White
    { 0x00, 0x00, 0x00 }, // Black Bright
    { 0x00, 0x00, 0xFF }, // Blue Bright
    { 0x00, 0xFF, 0x00 }, // Green Bright
    { 0x00, 0xFF, 0xFF }, // Cyan Bright
    { 0xFF, 0x00, 0x00 }, // Red Bright
    { 0xFF, 0x00, 0xFF }, // Magenta Bright
    { 0xFF, 0xFF, 0x00 }, // Yellow Bright
    { 0xFF, 0xFF, 0xFF }  // White Bright
  };

static const rgb_palette_t rgb_palette_orthodox = 
{
    { 0x00, 0x00, 0x00 }, // Black
    { 0x00, 0x00, 0xCD }, // Blue
    { 0x00, 0xB7, 0x00 }, // Green
    { 0x00, 0xB7, 0xCD }, // Cyan
    { 0xA7, 0x00, 0x00 }, // Red
    { 0xA7, 0x00, 0xCD }, // Magenta
    { 0xA7, 0xB7, 0x00 }, // Yellow
    { 0xA7, 0xB7, 0xCD }, // White
    { 0x00, 0x00, 0x00 }, // Black Bright
    { 0x00, 0x00, 0xFF }, // Blue Bright
    { 0x00, 0xE4, 0x00 }, // Green Bright
    { 0x00, 0xE4, 0xFF }, // Cyan Bright
    { 0xD0, 0x00, 0x00 }, // Red Bright
    { 0xD0, 0x00, 0xFF }, // Magenta Bright
    { 0xD0, 0xE4, 0x00 }, // Yellow Bright
    { 0xD0, 0xE4, 0xFF }  // White Bright
};

// Modified default EGA palette: default palette entry number 6 (index 20 brown) replaced with index 6 (yellow)
static const rgb_palette_t rgb_palette_ega = 
{
    { 0x00, 0x00, 0x00 }, // Black
    { 0x00, 0x00, 0xAA }, // Blue
    { 0x00, 0xAA, 0x00 }, // Green
    { 0x00, 0xAA, 0xAA }, // Cyan
    { 0xAA, 0x00, 0x00 }, // Red
    { 0xAA, 0x00, 0xAA }, // Magenta
    { 0xAA, 0xAA, 0x00 }, // Yellow
    { 0xAA, 0xAA, 0xAA }, // White
    { 0x00, 0x00, 0x00 }, // Black Bright
    { 0x55, 0x55, 0xFF }, // Blue Bright
    { 0x55, 0xFF, 0x55 }, // Green Bright
    { 0x55, 0xFF, 0xFF }, // Cyan Bright
    { 0xFF, 0x55, 0x55 }, // Red Bright
    { 0xFF, 0x55, 0xFF }, // Magenta Bright
    { 0xFF, 0xFF, 0x55 }, // Yellow Bright
    { 0xFF, 0xFF, 0xFF }  // White Bright
};

const rgb_palette_t *rgb_palettes[RGB_PALETTE_SIZE] = {&rgb_palette_alone, &rgb_palette_pulsar, &rgb_palette_orthodox, &rgb_palette_ega};

static uint8_t g_rgb_palette_index = RGB_PALETTE_MIN;

void set_rgb_palette_index(uint8_t palette_index)
{
    if (palette_index > RGB_PALETTE_MAX)
        palette_index = RGB_PALETTE_MIN;
    else if (palette_index < RGB_PALETTE_MIN)
        palette_index = RGB_PALETTE_MAX;

    g_rgb_palette_index = palette_index;
};

uint8_t get_rgb_palette_index()
{
    return g_rgb_palette_index;
}

const rgb_palette_t* get_rgb_palette()
{
    return rgb_palettes[g_rgb_palette_index];
}